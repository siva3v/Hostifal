<!DOCTYPE html>
<html>

<head>
    <title>My Product Brand Name</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://siva3v.github.io/Hostifal/azrad/modern-normalize.css">

    <style>

    </style>

    <script async>
        //&infnphone=9998887776
        let params = new URL(document.location).searchParams;
        let phoneNumber = params.get("infnphone"); // is the string "Jonathan Smith".

        init()

        function init() {
            const azf = document.getElementById("attributeVerification");
            //const inf = document.getElementById("phoneBlock");
            if (azf) {
                setAction()

            } else {
                setTimeout(() => init(), 100)
            }
        }

        function isVisible(el) {
            if (el && el.style.display !== 'none') return true
            else return false
        };

        function verifyOtp(){
            const infnOtpField = document.getElementById("infn_phone_otp")
            const otpField = document.getElementById("phoneVerificationCode")
            otpField.value = infnOtpField.value
            const nextButton = document.getElementById("phoneVerificationControl_but_verify_code");
            nextButton.click()
        }

        function setAction() {
            const nextButton = document.getElementById("continue");
            const trues = ["send_code", "verify_code", "send_new_code", "change_claims"].map(pid =>
                isVisible(document.getElementById("phoneVerificationControl_but_" + pid))
            )

            if (nextButton && !trues.includes(true)) {
                console.log("nextButton 1")
                //nextButton.click()
            } else if (trues[0] && !trues[1]) {
                console.log(phoneNumber)
                const phoneField = document.getElementById("nationalNumber");
                const countryCode = document.getElementById("countryCode")
                if (phoneNumber && phoneField && countryCode) {
                    phoneField.value = phoneNumber
                    for (x in countryCode.options) if (countryCode.options[x].innerText == "India(+91)") countryCode.options[x].selected = true;
                    const nextButton = document.getElementById("phoneVerificationControl_but_send_code");
                    console.log("nextButton 0")
                    nextButton.click()
                }
            }
        }

        function observeDOM() {
            const targetDiv = document.getElementById('phoneVerificationControl_but_change_claims');
            const config = { attributes: true, childList: true, subtree: true };
            if (targetDiv) {
                const observer = new MutationObserver((mutationsList, observer) => {
                    for (const mutation of mutationsList) {
                        setAction()
                        if (mutation.type === 'childList') {
                            console.log('A child node has been added or removed.');
                        } else if (mutation.type === 'attributes') {
                            console.log('Attributes of the observed element have changed.');
                        }
                    }
                });
                observer.observe(targetDiv, config);
            } else {
                setTimeout(() => observeDOM(), 250)
            }
        }

    </script>


</head>


<body>
    <p style="margin: 1rem;" onclick="setAction()">28</p>

    <input type="number" id="infn_phone_otp" maxlength="6" />
    <button onclick="verifyOtp()">Verify OTP</button>

    <div id="api"> </div>
</body>

</html>

<!---
    https://azureinfineyauth.b2clogin.com/azureinfineyauth.onmicrosoft.com/oauth2/v2.0/authorize?
    p=B2C_1_azrinfnphna&
    client_id=a54d206c-3a55-4b43-a094-21f4b4ba3408&
    nonce=defaultNonce&
    redirect_uri=http%3A%2F%2Flocalhost%3A5173%2F&
    scope=openid&
    response_type=code&prompt=login
    &infnphone=7013522603
-->