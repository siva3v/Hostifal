<!DOCTYPE html>
<html>

<head>
    <title>Infiney Auth</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://siva3v.github.io/Hostifal/azrad/modern-normalize.css">

    <style>

    </style>

    <script async>
        let params = new URL(document.location).searchParams;
        let phoneNumber = params.get("infnphone");

        init()

        function init() {
            const avr = document.getElementById("attributeVerification");
            if (avr) {
                setPhoneNumber()
                setSendCode()
            } else {
                setTimeout(() => init(), 100)
            }
        }

        function setPhoneNumber() {
            const phoneField = document.getElementById("phoneNumber");
            if (phoneField) {
                const nextButton = document.getElementById("next");
                phoneField.value = phoneNumber
                nextButton.click()
            }
        }

        function setSendCode() {
            const countryCode = document.getElementById("countryCode")
            if (countryCode) {
                for (x in countryCode.options) if (countryCode.options[x].innerText == "India(+91)") countryCode.options[x].selected = true;
                const nextButton = document.getElementById("continue");
                nextButton.click()
            }
        }

        function verifyCode() {
            if (phoneNumber) {
                const infnOtpField = document.getElementById("infn_phone_otp")
                const otpField = document.getElementById("phoneVerificationCode")
                otpField.value = infnOtpField.value
                const nextButton = document.getElementById("phoneVerificationControl_but_verify_code");
                nextButton.click()
            }
        }

        function completeAuth() {
            const nextButton = document.getElementById("continue");
            nextButton.click()
        }

        function testa() {

        }

        function setnotif(vl) {
            console.log(vl)
            const infn_notifs = document.getElementById('infn_notifs');
            infn_notifs.innerText = vl
            if (vl == "The code has been verified. You can now continue.") {
                completeAuth()
            } else if (vl == "You are already registered, please press the back button and sign in instead.") {

            }
        }

        function observeDOM(id, fun) {
            const targetDiv = document.getElementById(id);
            fun(targetDiv.innerText)
            const config = { attributes: true, childList: true, subtree: true };
            if (targetDiv) {
                const observer = new MutationObserver((mutationsList, observer) => fun(targetDiv.innerText));
                observer.observe(targetDiv, config);
            } else {
                setTimeout(() => observeDOM(), 250)
            }
        }

    </script>


</head>


<body>
    <p style="margin: 1rem;" onclick="testa()">34</p>

    <div style="margin: 1rem;" id="infn_notifs"></div>

    <input type="number" id="infn_phone_otp" maxlength="6" />
    <button onclick="verifyCode()">Verify OTP</button>

    <div id="api" > </div>

</body>

</html>

<!---
    https://azureinfineyauth.b2clogin.com/azureinfineyauth.onmicrosoft.com/oauth2/v2.0/authorize?
    p=B2C_1_azrinfnphna&
    client_id=a54d206c-3a55-4b43-a094-21f4b4ba3408&
    nonce=defaultNonce&
    redirect_uri=http%3A%2F%2Flocalhost%3A5173%2F&
    scope=openid&
    response_type=code&prompt=login
    &infnphone=7013522603


    style="width: 1px; height: 1px; overflow: hidden;"
-->